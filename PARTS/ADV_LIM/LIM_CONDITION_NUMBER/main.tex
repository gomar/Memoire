%!TEX root = ../../../adrien_gomar_phd.tex

\chapter{Conditioning of multi-frequential harmonic balance methods}
\label{cha:limitations_condition_number}

\chabstract{Problems characterized by multiple frequencies,
as for instance the aeroelasticity of contra-rotating open
rotors, require 
multi-frequential harmonic balance discretization operators.
These can be ill-conditioned for some combinations 
of the discrete frequencies.
In this chapter, we investigate the sensitivity of 
harmonic balance solutions to the condition number of the 
discrete Fourier transform matrix for a linear advection problem
and a non-linear channel flow problem.
Highlighted is the fact that when the condition number is greater
than one, the unsteadiness can be badly reproduced preventing the use
of such an approach.
To improve the condition number, we consider a non-uniform
distribution of the time instants (\citet{ThesisGuedeney}),
along with an optimization algorithm minimizing the
condition number of the discrete Fourier transform matrix.
The optimization algorithm developed
in the present work gives very good results for any input frequencies,
enabling the use of the multi-frequential harmonic balance
for the simulation of contra-rotating open rotor aeroelasticity.
This work has been published in
\begin{quote}
	\citetalias{JGuedeney2013}
\end{quote}}


\newpage

\section{Condition number and contra-rotating open rotor aeroelasticity}
\label{sec:condition_cror_ael}
\input{PARTS/ADV_LIM/LIM_CONDITION_NUMBER/condition_cror_ael}

\section{Highlighting the problem}
\label{sec:condition_pbm}
\input{PARTS/ADV_LIM/LIM_CONDITION_NUMBER/condition_pbm}

\section{Proposed cure: automatic optimization of time instants} % (fold)
\label{sec:condition_solution}
\input{PARTS/ADV_LIM/LIM_CONDITION_NUMBER/condition_solution}

\chconclu{In this chapter, we demonstrated 
that the time sampling has a major effect on the
stability of the multi-frequential harmonic balance 
approach, due to the condition number of the discrete Fourier
transform matrix. One way to tackle this issue, 
is to consider a non-uniform time sampling
along with an algorithm to properly choose the time instants
as proposed by \citet{ThesisGuedeney}.
The Almost-Periodic Fourier Transform algorithm (APFT) 
algorithm, originally developed by \citet{Kundert1988} and implemented by 
\citet{ThesisGuedeney}, is shown to improve the discrete
Fourier transform matrix condition number.
However, for segregated frequencies, this condition number
is shown to remain too large to be used within an industrial context.
As the aeroelasticity of contra-rotating open rotors is by essence
composed of segregated frequencies, new algorithms are needed.
This is why, a gradient-based OPTimization algorithm (OPT) 
has been developed in the current work.
It directly minimizes the condition number thanks to a
gradient-based optimization method. This last has proved to
give a condition number that is almost unity (\emph{i.e.} the
theoretical lower bound) for any input frequencies,
thus alleviating the stability issues encountered for arbitrary
multi-frequential HB computations.}
