%!TEX root = ../../../adrien_gomar_phd.tex

\chapter{Convergence of Fourier-based 
time methods for turbomachinery wake passing problems}
\label{cha:limitations_convergence}

\defcitealias{JGomar2013}{{\small \emph{A. Gomar}, Q. Bouvy, F. Sicot, G. Dufour, P. Cinnella, and B. Fran\c cois. Convergence of Fourier-based time methods for turbomachinery wake passing problems. 
\emph{Journal of Computational Physics}, submitted in December 2013}}

\chabstract{Theoretical results about the convergence of spectral methods 
(see \emph{e.g.} \citet{Canuto2006}
for a comprehensive review) predict convergence of the numerical 
solution starting from a given number of harmonics, provided 
that the approximated function satisfies some regularity 
requirements~\cite{Zygmund1959}. 
Nevertheless, this number of harmonics is configuration-dependent 
and hardly predictable. Studies on the convergence of 
Fourier-based time methods for turbomachinery simulations 
have been previously reported in the literature, but with scattered results. 
For instance, using a frequency-domain approach, 
\citet{Vilmin2006} obtain accurate solutions 
using 5~harmonics for a compressor stage and 3~harmonics for a 
centripetal turbine stage. For a transonic compressor stage with 
forced blade vibration, \citet{ekici2010} use 
up to 7~harmonics with a time-domain harmonic balance approach. Finally, for a 
subsonic compressor stage, \citet{JSicot2012} report 
that 4~harmonics is the minimal requirement to properly capture wake interactions.
The goal of the present chapter is to analyze the
convergence of Fourier-based time method, 
with focus on turbomachinery applications. 
In this aim, the HB method is applied to 
the linear advection equation 
supplemented with unsteady boundary conditions 
of different degrees of smoothness,
to highlight the impact of solution regularity 
on HB convergence. 
Then, a model problem representative of a turbomachinery wake-passing 
configuration is set up, and different
error measures are introduced to compare the numerical and analytical solutions. 
These error measures allows finally to define a prediction tool, 
which will be applied to contra-rotating open rotor simulations
in Chapters~\ref{cha:dream_ls_isolated} and~\ref{cha:dream_hs_isolated}.
This work has been submitted in
\begin{quote}
	\citetalias{JGomar2013}
\end{quote}}


\newpage

\section{Periodic problems with an infinite Fourier spectrum}
\label{sec:rectangular_fct}
\input{PARTS/ADV_LIM/LIM_CONVERGENCE/rectangular_fct}

\section{Toward turbomachinery wakes}
\label{sec:wake_fct}
\input{PARTS/ADV_LIM/LIM_CONVERGENCE/wake_fct}

\section{Application to a model turbomachinery configuration}
\label{sec:model_tbm}
\input{PARTS/ADV_LIM/LIM_CONVERGENCE/model_tbm}

% \section*{Summary}

% We have seen that the convergence rate 
% of Fourier-based time methods and hence the harmonic balance approach, 
% in terms of harmonics required to describe the solution 
% with a given level of accuracy, depends on the spectral content of the 
% solution itself: Fourier-based time methods are particularly efficient 
% for flow problems characterized by a narrow Fourier 
% spectrum. We show that main source of unsteadiness in 
% turbomachinery flows is due to the relative motion of wakes 
% generated by a given blade row with respect to the downstream row. 
% Statistically speaking, the passing wakes are seen by the downstream 
% row as an azimuthally advected periodic Gaussian pulse, 
% characterized by its relative thickness compared to the pitch 
% in between two subsequent blades and by the velocity deficit 
% associated to it. We show that the narrower the wake, the larger 
% its Fourier spectrum, and the slower the convergence of Fourier-based time methods.
% In order to achieve \emph{a priori} estimates of the number of 
% harmonics required to accurately solve a given turbomachinery 
% problem, we introduce two error measures based on the relative 
% thickness of the passing wakes. It is shown that, for practical 
% purposes, these can be preliminarily estimated by running a 
% companion steady simulation of the turbomachinery stage. The 
% steady simulation is post-processed to extract information about 
% the spanwise distribution of wake thickness, and an error criterion 
% is used to estimate the number of harmonics required to resolve 99\% 
% of the energy content associated to the velocity signal. The 
% preliminary step has a negligible cost compared to the overall 
% simulation, since the steady computation is used to initialize 
% the unsteady run, and extraction of wake characteristics takes 
% less than a minute on a single processor. 
% The proposed methodology represents an efficient and reliable 
% operational tool to guide the choice of the number of harmonics 
% for a given turbomachinery problem, and to evaluate beforehand the 
% interest of applying or not a Fourier-based time integration scheme 
% instead of a classical time-marching scheme.
