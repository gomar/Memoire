%!TEX root = ../../../adrien_gomar_phd.tex

\subsection{Presentation of the case}

We consider the linear advection equation:
\begin{equation}
  \label{eq:convection}
  \frac{\partial u}{\partial t} + c \frac{\partial u}{\partial x} = 0,
\end{equation}
with the constant advection speed $c$ assumed as positive
and set here to one for simplicity. 
The equation is solved on the domain $x \in [0, 1]$. 
Periodic perturbations of different shapes are imposed at the left boundary:
\begin{equation}
   u(0, t) = u_l (t),
\end{equation}
where $u_l$ is a periodic function of period $T=1/c$.
These perturbations are advected across the computational 
domain and leave from the right boundary. After a transient of time length $T_{trans}=1/c$, 
the solution at any point $x$ in the space domain achieves a periodic state. 
The exact solution for this periodic state is a periodic function of the form:
\begin{equation}
    u_{ex}(x,t)=u_l(x/c+t).
\end{equation}

\subsection{Numerical setup}

The space derivative is discretized by means of a centered 
fourth-order finite difference scheme on an uniform Cartesian mesh:
\begin{equation}
    \frac{\partial u}{\partial x} (x = x^i, t=t_q) \approx 
    \frac{-u^{i+2}_{q} + 8 u^{i+1}_{q} - 8 u^{i-1}_{q} + u^{i-2}_{q}}{12\Delta x},
    \label{eq:convection_center4}
\end{equation}
A very fine space step is used ($\Delta x=0.002$) in order to rule 
out spatial approximation errors. According to the theory 
of characteristics, the solution at the last mesh 
point on the right of the domain is extrapolated 
from the inside. To this aim, a standard second-order 
upwind discretization and a first-order upwind discretization 
are used to approximate the space derivative at 
the last two mesh points on the right, respectively:
\begin{align}
    \frac{\partial u}{\partial x} (x = x^{m-1}, t=t_q) &\approx 
    \frac{3 u^{m-1}_{q} - 4 u^{m-2}_{q} + u^{m-3}_{q}}{2\Delta x}, \\
    \frac{\partial u}{\partial x} (x = x^m, t=t_q) &\approx 
    \frac{u^{m}_{q} - u^{m-1}_{q}}{\Delta x}.
\label{eq:upwind_scheme}
\end{align}
Time-discretization is achieved 
through the HB method described in Sec.~\ref{sec:sm_hb}:
with a standard four-step Runge-Kutta method~\cite{Jameson1981}
used to pseudo-time 
march the HB equations to the steady state.
The $k\textsuperscript{th}$ step is evaluated by:
\begin{equation}
    u_k = u_q - \alpha_k \Delta t \left [ 
          c \frac{\partial u_{k-1}}{\partial x} (t=t_q + \alpha_{k-1} \Delta t)
          + D_t(u_k)
          \right],
    \label{eq:convection_rk4}
\end{equation}
where the HB source term $D_t(u_k)$ is computed using Eq.~\eqref{eq:sm_multi_spectral_operator},
$\alpha_0 = 0$, $\alpha_1 = 1/4$, 
$\alpha_2 = 1/3$, $\alpha_3 = 1/2$ and $\alpha_4 = 1$.
The CFL number in pseudo-time is set to 1 
to ensure stability of the explicit time-marching scheme.

To compare numerical and exact solutions, 
the discrete $\mathcal{L}_2$-norm of the error 
in time is computed over all the time instances
at each grid points over the domain.
Then, the average in 
space is computed.


